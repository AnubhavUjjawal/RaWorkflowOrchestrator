{% extends "airflow/master.html" %}
{% block title %}
  {{ title }}
{% endblock %}
{% block content %}
  {{ super() }}
  <h3>{{title}}</h3>
  <p class="lead">Set your Livy configuration for Remote Spark Access in Jupyter Notebooks here.</p>
  <div class="container">
    <div class="row">
      <div class="col-md-9">
        {% for section in sections %}
          <h4>{{section}}</h4>
          <form method="POST">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <input type="hidden" name="section" value="{{section}}">
            {% if sections[section]['type'] != 'nested' %}
              <div class="form-group">
                <input type="{{sections[section]['type']['type']}}"
                  class="form-control"
                  name="config-{{section}}"
                  value="{{config[section]}}"
                  >
              </div>
            {% else %}
              {% for key, val in sections[section].items() %}
                {% if key != 'type' %}
                <div class="form-group">
                  <label for="config-{{key}}">
                    {{key}}
                  </label>
                  {% if val['type'] == 'select' %}
                  <select name="config-{{key}}" id="" class="form-control">
                    {% for option in val['options'] %}
                      {% if option == config[section].get(key, '') %}
                      <option value="{{option}}" selected>{{option}}</option>
                      {% else %}
                      <option value="{{option}}">{{option}}</option>
                      {% endif %}
                    {% endfor %}
                  </select>
                  {% else %}
                  <input type="{{val['type']}}"
                        class="form-control"
                        autocomplete="new-password"
                        name="config-{{key}}"
                        value="{{config[section].get(key, '')}}"
                  >
                  {% endif %}
                </div>
                {% endif %}
              {% endfor %}
            {% endif %}
          <button type="submit" class="btn btn-primary pull-right">Save Changes</button>
          <br>
          </form>
        {% endfor %}
      </div>
    </div>
  </div>
{% endblock %}
